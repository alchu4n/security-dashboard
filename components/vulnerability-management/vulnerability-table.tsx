import { Badge } from "@/components/ui/badge"
import { Button } from "@/components/ui/button"
import { ExternalLink } from "lucide-react"

export function VulnerabilityTable() {
  // Sample vulnerability data
  const vulnerabilities = [
    {
      id: "CVE-2023-1234",
      name: "Apache Log4j远程代码执行漏洞",
      severity: "严重",
      cvss: 9.8,
      affected: "Web服务器",
      status: "未修复",
      discovered: "2023-03-15",
    },
    {
      id: "CVE-2023-5678",
      name: "SQL注入漏洞",
      severity: "高",
      cvss: 8.5,
      affected: "CRM系统",
      status: "修复中",
      discovered: "2023-03-20",
    },
    {
      id: "CVE-2023-9012",
      name: "跨站脚本攻击(XSS)漏洞",
      severity: "中",
      cvss: 6.4,
      affected: "Web应用",
      status: "已修复",
      discovered: "2023-03-25",
    },
    {
      id: "CVE-2023-3456",
      name: "权限提升漏洞",
      severity: "高",
      cvss: 7.8,
      affected: "Windows服务器",
      status: "未修复",
      discovered: "2023-03-28",
    },
    {
      id: "CVE-2023-7890",
      name: "拒绝服务漏洞",
      severity: "中",
      cvss: 5.9,
      affected: "网络设备",
      status: "已修复",
      discovered: "2023-04-02",
    },
    {
      id: "CVE-2023-2345",
      name: "信息泄露漏洞",
      severity: "低",
      cvss: 3.5,
      affected: "邮件服务器",
      status: "已修复",
      discovered: "2023-04-05",
    },
    {
      id: "CVE-2023-6789",
      name: "缓冲区溢出漏洞",
      severity: "严重",
      cvss: 9.2,
      affected: "数据库服务器",
      status: "修复中",
      discovered: "2023-04-08",
    },
    {
      id: "CVE-2023-1357",
      name: "不安全的加密存储",
      severity: "中",
      cvss: 6.0,
      affected: "认证服务",
      status: "未修复",
      discovered: "2023-04-10",
    },
  ]

  const getSeverityBadge = (severity: string) => {
    switch (severity) {
      case "严重":
        return <Badge variant="destructive">严重</Badge>
      case "高":
        return (
          <Badge variant="outline" className="bg-red-100 text-red-800 hover:bg-red-100">
            高
          </Badge>
        )
      case "中":
        return (
          <Badge variant="outline" className="bg-yellow-100 text-yellow-800 hover:bg-yellow-100">
            中
          </Badge>
        )
      case "低":
        return (
          <Badge variant="outline" className="bg-blue-100 text-blue-800 hover:bg-blue-100">
            低
          </Badge>
        )
      default:
        return <Badge variant="outline">未知</Badge>
    }
  }

  const getStatusBadge = (status: string) => {
    switch (status) {
      case "已修复":
        return (
          <Badge variant="outline" className="bg-green-100 text-green-800 hover:bg-green-100">
            已修复
          </Badge>
        )
      case "修复中":
        return (
          <Badge variant="outline" className="bg-blue-100 text-blue-800 hover:bg-blue-100">
            修复中
          </Badge>
        )
      case "未修复":
        return (
          <Badge variant="outline" className="bg-red-100 text-red-800 hover:bg-red-100">
            未修复
          </Badge>
        )
      default:
        return <Badge variant="outline">未知</Badge>
    }
  }

  return (
    <div className="overflow-auto">
      <table className="w-full border-collapse">
        <thead>
          <tr className="border-b bg-muted/50 text-sm text-muted-foreground">
            <th className="px-4 py-3 text-left font-medium">CVE ID</th>
            <th className="px-4 py-3 text-left font-medium">漏洞名称</th>
            <th className="px-4 py-3 text-left font-medium">严重性</th>
            <th className="px-4 py-3 text-left font-medium">CVSS</th>
            <th className="px-4 py-3 text-left font-medium">受影响系统</th>
            <th className="px-4 py-3 text-left font-medium">状态</th>
            <th className="px-4 py-3 text-left font-medium">发现日期</th>
            <th className="px-4 py-3 text-left font-medium">操作</th>
          </tr>
        </thead>
        <tbody>
          {vulnerabilities.map((vuln) => (
            <tr key={vuln.id} className="border-b text-sm hover:bg-muted/50">
              <td className="px-4 py-3 font-medium">{vuln.id}</td>
              <td className="px-4 py-3">{vuln.name}</td>
              <td className="px-4 py-3">{getSeverityBadge(vuln.severity)}</td>
              <td className="px-4 py-3">{vuln.cvss}</td>
              <td className="px-4 py-3">{vuln.affected}</td>
              <td className="px-4 py-3">{getStatusBadge(vuln.status)}</td>
              <td className="px-4 py-3 text-muted-foreground">{vuln.discovered}</td>
              <td className="px-4 py-3">
                <Button variant="ghost" size="icon" className="h-8 w-8">
                  <ExternalLink className="h-4 w-4" />
                  <span className="sr-only">查看详情</span>
                </Button>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  )
}
